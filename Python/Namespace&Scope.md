# Namespace and Variable Scope

## Intro
파이썬은 변수가 어디에 위치하느냐에 따라 해당 변수가 영향을 미치는 범위가 달라진다
```python
x = 'out'
def test():
	x = 'in'

test()
print(x)
```
위의 예시의 경우 출력되는 x는 `out`이다. <br>
`test()`가 함수 밖에 존재하는 코드와 별개의 **다른 범위**를 가지고 있기 때문이다.<br>
> 함수 내부에 있는 x(in)는 test()라는 함수가 가지고 있는 _'지역 네임스페이스'_ 에 있기에<br>
> 함수 외부에 있는 _'전역변수 x(out)'_ 에 접근하지 못한다

## 1. Namespace
* 네임 스페이스 : 프로그래밍 언어에서 **특정한 객체를 이름에 따라 구분할 수 있는 범위**
* 객체로 이루어진 파이썬 내부의 모든 것은 각각 특정 이름과 매핑관계를 맺는데 `이 매핑을 포함하고 있는 공간`을 의미

> 모든 변수,함수 모든게 겹치지 않게 하는것이 매우 어려워,<br>
> 프로그래밍 언어는 네임스페이스를 도입해 특정한 하나의 이름이 통용되는 범위를 지정함으로써 범위별로 같은이름이지만 다른 객체임을 알 수 있다.

### Namespace 특징
| 파이썬 공식문서에서 namespace를 보면 간략하지만 아래의 특징을 서술하고 있다
* 네임스페이스는 `딕셔너리 형태`로 구현되어있다
* 모든 이름자체는 문자열로 되어있으며, 각각은 해당 네임스페이스 범위에서 실제 객체를 가진다.
* 이름과 객체사이의 매핑은 가변적으로 런타임동안 새로운 이름이 추가될 수 있다.
* 다만 기본 내장,예외 이름인 빌트인 네임스페이스는 함부로 추가, 삭제 될 수 없다

### Namespace 종류
![reference from https://www.programiz.com/python-programming/namespace](https://cdn.programiz.com/sites/tutorial2program/files/nested-namespaces-python.jpg)
1. 빌트인(Built-in) 네임스페이스: 기본 내장 함수 및 기본 예외들의 이름들이 소속된다. 파이썬으로 작성된 모든 코드 범위가 포함된다.
2. 전역(Global) 네임스페이스: **모듈별**로 존재하며, 모듈 전체에서 통용될 수 있는 이름들이 소속된다. 
3. 지역(Local) 네임스페이스: **함수 및 메서드 별**로 존재하며, 함수 내의 지역 변수들의 이름들이 소속된다.
___

## 2. Scope
위의 네임스페이스의 접근성과 관련된 개념으로<br>
코드안에서 변수나 함수같은 특정 이름을 사용할 때, 파이썬은 그 사용된 이름의 값을 정하기위해 현재 범위를 체크한다

> **파이썬의 Scope종류** <br>
> 지역 스코프(Local Scope): 함수 내부에서 생성되는 Scope<br>
> 전역 스코프(Global Scope: 모듈(파이썬 파일) Scope<br>
> 내장 스코프(Built-in Scope: 파이썬 자체 내장 영역 Scope<br>

## 변수(이름)을 찾는 순서 : LEGB Rule
> **Local** - **Enclosing** - **Global** - **Bulit-in** 의 순서대로 범위를 결정한다.

###### ? enclosing : 지역범위의 한단계 위 범위로, 지역범위가 내부함수안이라면 enclosing범위는 외부함수이다 <br> (지역범위가 최고 상위의 함수라면 enclosing범위는 전역범위이다)

## global, nonlocal
전역 변수, 혹은 지역 변수를 특정한 스코프 내에서 사용해야 할 때가 있는데, 이 때 `global` 과 `nonlocal` 키워드를 사용한다.
#### 1. 더 넓은 범위의 있는 변수는 `읽기`는 가능 -> `변경`은 불가능
```python
n = 100 
def func(): 
	print(n) # 100
func()

# 변경시 에러 발생
n = 100 
def func(): 
	n += 1 # error 
	print(n) 
func()

```
위의 케이스에서 **global** 키워드를 사용해 해결이 가능하다(현재 scope의 위치에 상관 없이 x라는 이름을 전역변수로 이용한다는 뜻)


#### 2. 현재 scope내 지역변수도, 전역변수도 아닌 변수를 사용시 -> 에러 발생
```python
def func1(): 
  n = 1 
  def func2(): 
    nonlocal n 
    n += 1
    print(n) # 2 
  func2() 
func1()
```
위의 케이스에서 **nonlocal** 을 이용할 수 있다(전역 변수를 포함한 상위 scope의 이름을 사용한다는 뜻)

> **< PS >** <br>
> 함수 내에서 전역 변수를 호출하는건 좋은 방법은 아니다 -> 나도 모르는 사이에 변수의 값을 어디선가 변경되어 문제가 발생했을때 추적이 어려울 수 있다 <br>
